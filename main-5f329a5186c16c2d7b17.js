(()=>{"use strict";class t{constructor(t){this.players=t,this.turnOrder=0}currentPlayer(){this.players[this.turnOrder]}}class e{constructor(t){this.board=t}}const n={};function i(t,e){void 0===n[t]&&(n[t]=[]),n[t].push(e)}function s(t){const e=document.createElement("div");e.classList.add("ship"),e.draggable=!0;for(let n=0;n<t;n+=1){const t=document.createElement("div");t.classList.add("ship-block"),e.append(t)}return e}class r{constructor(t,e){this.whiteSpace=t.whiteSpace(),this.hitMark=t.hitBoardMark(),this.missMark=t.missBoardMark(),this.board=t.createBoard(e),this.ships=new Map,this.shipCount=0,this.size=e}attackPlace(t){const e=t.getX(),n=t.getY(),i=this.board[e][n];this.ships.has(i)?(this.ships.get(i).hit(),this.board[e][n]=this.hitMark):this.board[e][n]=this.missMark}allShipAreSunk(){const t=this.ships.values();return Array.from(t).every((t=>t.isSunk()))}canPlaceShip(t,e,n){const i=e.getLength();return this.#t(t,i,n)&&this.#e(t,i,n)}placeShip(t,e,n){let i=e.getX(),s=e.getY();const r=t.getLength(),o=this.shipCount.toString();for(let t=0;t<r;t+=1)this.board[s][i]=o,n?i+=1:s+=1;this.ships.set(o,t),this.shipCount+=1}#t(t,e,n){return e+(n?t.getX():t.getY())<this.size}#e(t,e,n){let i=t.getX(),s=t.getY(),r=!0;for(let t=0;t<e;t+=1)r=r&&this.emptyLocation(s,i),n?i+=1:s+=1,t+=1;return r}emptyLocation(t,e){return this.board[t][e]===this.whiteSpace}}const o=[s(3),s(4),s(1),s(2),s(3)],a=new class{whiteSpace(){return"-"}hitBoardMark(){return"x"}missBoardMark(){return"o"}createBoard(t){const e=[];for(let n=0;n<t;n+=1){const n=this.getBoardRow(t);e.push(n)}return e}getBoardRow(t){const e=this.whiteSpace(),n=[];for(let i=0;i<t;i+=1)n.push(e);return n}},c=new class{constructor(t,e){this.boardFctory=t,this.size=e,this.board=new r(t,e)}reset(){this.board=new r(this.boardFctory,this.size)}}(a,10),h=new class{constructor(t){this.boardBuilder=t}reset(){this.boardBuilder.reset()}create(){const n=this.boardBuilder.build(),i=new e(n);return new t([i])}}(c),u=new class{constructor(t){this.game=null,this.gameFactory=t}init(){i("configure-new-game",this.newGameConfiguration.bind(this))}newGameConfiguration(){this.gameFactory.reset()}}(h),d=document.querySelector(".game-section"),l=new class{constructor(t){this.gameSection=t,this.menuButton=document.querySelector(".menu-button"),this.newGameButton=function(){const t=document.createElement("button");return t.innerText="New Game",t.classList.add("new-game-button"),t}(),this.onClick=this.emitDisplayConfigurationScreen.bind(this)}init(){this.menuButton.addEventListener("click",this.toggleMenuOnScreen.bind(this)),this.toggleMenuOnScreen()}toggleMenuOnScreen(){this.gameSection.contains(this.newGameButton)?(this.newGameButton.removeEventListener("click",this.onClick),this.gameSection.removeChild(this.newGameButton)):(this.gameSection.append(this.newGameButton),this.newGameButton.addEventListener("click",this.onClick))}emitDisplayConfigurationScreen(){this.toggleMenuOnScreen(),n["configure-new-game"].forEach((t=>t(null)))}}(d),m=new class{constructor(t,e,n){this.gameSection=t,this.ships=e,this.boardSize=n}init(){i("configure-new-game",this.renderGameConfiguration.bind(this))}renderGameConfiguration(){const t=function(t,e){const n=document.createElement("div"),i=function(){const t=document.createElement("div");t.classList.add("board");for(let e=0;e<7;e+=1){const e=document.createElement("div");for(let t=0;t<7;t+=1){const t=document.createElement("div");e.append(t)}t.append(e)}return t}(),s=document.createElement("h2"),r=function(t){const e=document.createElement("div");return t.forEach((t=>{e.append(t)})),e}(t);return r.classList.add("ships-section"),n.classList.add("configuration-screen"),s.innerText="Arrange your boats",s.classList.add("configuration-title"),n.append(s),n.append(i),n.append(r),n}(this.ships,this.boardSize);this.gameSection.append(t)}}(d,o,10);l.init(),m.init(),u.init()})();